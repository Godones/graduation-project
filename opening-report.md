# 开题报告

## 选题依据

简述该选题的研究意义和背景，国内外研究概况和发展趋势等



## 研究背景

计算机的文件系统是一种存储和组织计算机数据的方法，它使得对数据的访问和查找变得容易，文件系统使用文件和树形目录的抽象逻辑概念代替了硬盘和光盘等物理设备使用数据块的概念，用户使用文件系统来保存数据而不必关心数据实际保存在硬盘（或者光盘）的地址为多少的数据块上，只需要记住这个文件的所属目录和文件名。在写入新数据之前，用户不必关心硬盘上的哪个块地址没有被使用，硬盘上的存储空间管理（分配和释放）功能由文件系统自动完成，用户只需要记住数据被写入到了哪个文件中。随着时间的推移，存储需求不断变化，数据量不断增加， 文件系统必须是可靠的、持久的、安全的、高效的、容错的和可扩展的，【File Systems for Various Operating Systems: A Review】 为了实现这些特性并跟上不断变化的计算需求和存储需求，不同的技术和文件系统随着时间的推移而被引入到操作系统中，但是绝大多数的文件系统实现仍然采用的是树状层次结构，提供给用户的接口仍然是`open`,`read/write`等。

在文件系统快速发展的同时，数据库系统同样也在随着需求的不断变化而快速迭代。数据库是以电子方式存储的系统数据集合，它可以包含任何类型的数据，包括文字、数字、图像、视频和文件。这些数据按一定的数据模型组织、描述和存储，具有较小冗余度、较高数据独立性和易扩展性，并可为各种用户共享。通常，数据库的实现以文件系统为基础，所有的数据库操作，如增删改查、备份等最后都会转换为对磁盘上文件的操作，但有时数据库并不想受到文件系统实现带来的影响，一个广泛的现象是许多数据库系统的实现都会包含一个缓存模块，以此来提高其性能和可靠性。除了一直占据主要地位的大型关系型数据库系统，如Mysql、SQLserver等，近年来也出现了一些嵌入式数据库和许多nosql数据库，这些数据库与传统的数据库相比，其对系统资源的占用更小，如sqlite，其与应用程序运行在同一个地址空间中，而不是像Mysql那样存在服务器端和客户端的区别，同时，新兴的nosql数据库虽然功能不如传统的大型关系型数据库完善，但根据需求的变化，这些nosql数据库在一些专有领域也有着不错的表现。

从数据库和文件系统的发展来看，两者是在互相改进，共同发展，从两者的功能来看，他们都是存储数据的一种管理方式。既然两者的功能如此相像，那一个值得思考的问题就是为什么大多数的数据库系统实现以文件系统为基础，而不能反其道而行之？文件系统的实现者是否可以重用数据库的基础设施以获得数据库提供的更多特性？更近一步地，文件系统的实现是否可以完全在一个数据库系统提供的接口上进行？



## 主要任务

基于数据库的文件系统实现曾经是研究热点，但由于性能以及其它原因，相关的项目最终都没有得到有效的落实。当前嵌入式数据库蓬勃发展，涌现出许多适用于不同场景的数据库实现，本文关注如何让文件系统与数据库系统相互融合，使得文件系统不仅可以在数据库之上构建，同时还能利用数据库的优势提供给用户更多接口使用。本课题主要完成以下工作:

1. 文件系统探究：分析linux系统中文件系统常用接口与功能
2. key-value数据库探究: 分析使用rust实现的jammdb数据库系统，总结其相关接口与功能
3. 使用rust编程语言实现一个基于key-value数据库(jammdb)的文件系统(DBFS)，文件系统支持常用的posix接口
4. 将DBFS与其它使用rust实现的文件系统(FAT32)进行对比分析，总结使用数据库系统构建文件系统带来的优势和不足之处。



## 国内外研究现状

早期，数据库系统的基础是底层的文件系统，许多管理数据的特性都只是在数据库系统上得到体现，而近年来，文件系统的设计开发中越来越借鉴了数据库相关技术的思想，二者不断融合发展。日志文件系统就是在借鉴数据库系统的日志和事务特性之后发展出的一种文件系统。在对文件系统进行修改时，需要进行很多操作，比如在扩展一个文件的大小时，需要对文件的元信息和磁盘元信息都需要修改，这些操作可能中途被打断，但是，理论上这些操作不是不可中断的。如果操作被打断，就可能造成文件系统出现不一致的状态，虽然可以使用一些工具对这些情况进行修复，如fsck，但这些工具在修复时需要扫描整个磁盘，繁琐且速度较慢。日志文件系统在修改磁盘数据时利用日志信息记录修改过程，如果文件系统发生崩溃，重启后只需要根据日志信息就可以恢复数据从而保证数据的一致性和完整性。发展较早的日志文件系统JFS[]、XFS[]如今在某些系统上仍然广泛使用。而较新的Btrfs[]、Ext4[]、NTFS[]等具有日志功能的文件系统在服务器系统与桌面系统上占据着主要地位。除了对数据库的日志和简单事务的借鉴之外，许多适应新需求的文件系统实现在设计中会直接包含事务ACID特性的设计，exF2FS[]是一个事务性的日志文件系统，其允许事务跨越多个文件，应用程序可以显式指定与事务关联的文件，同时其允许使用少量内存执行事务并在一个事务中封装多个更新。DurableFS【】提供了一种受限制的事务形式：文件打开和关闭之间的操作自动形成具有原子性和持久性保证的事务。

一些文件系统的实现不再局限于在文件系统的设计上引入数据库系统的特性，而是选择直接基于数据库系统进行文件系统的实现，考虑到数据库系统提供的特性的实现复杂度，这种方案在实施难度上要远远小于重新设计文件系统。IFS【】是一个基于关系型数据库POSTGRES实现的文件系统，其向用户提供事务特性以及时间旅行功能，同时其使用多张关系表来构建层级文件系统以最大限度地支持传统POSIX接口。

Oracle iFS【】是一个运行在数据库之上的文件系统，实质上，Oracle iFS 提供了文件系统和数据库之间的范式转换，同时提高了一些高级搜索和数据备份功能。国内学者【】将Oracle iFS移植到linux的VFS模块中使得用户对其使用就如原有的文件系统一样，并且将基于内容分类、关联访问、基于内容的访问、版本控制等功能扩展到VFS中。AMINO【】是一个具有ACID语义的文件系统，其使用Berkeley Database作为后备存储，将一个易于使用但功能强大的嵌套事务API导出到用户空间。 应用程序可以开始、提交和中止事务，同时其设计了一个简单的API，使协作进程能够共享事务。 使用相同的API，单个应用程序可以支持多个并发事务。该文件系统不仅为应用程序提供了ACID的额外好处，在性能方面也与ext3相当。



## 研究方案

拟采用的研究方法、技术路线、实验方案及可行性分析等

已经有许多学者在文件系统中引入数据库系统特性或者直接在数据库系统上构建文件系统，这些文件系统在提供基础的文件系统功能上还引入了新的特性，有效地保障了文件系统的一致性和完整性。本课题根据前人已有的实践经验，使用一个已有key-value数据库构建一个文件系统，并支持常见的POISX接口。

### 研究方法

**文献研究法**: 通过图书馆、互联网、电子资源数据库等途径查阅大量文献，理解数据库系统、文件系统等相关知识，学习数据库实现的有关理论知识，获取前人在数据库和文件系统融合方面的研究信息，为后续的DBFS设计提供思路和参照。

**实验研究法**：通过梳理选取的jammdb数据库实现，设计通用的层级文件系统在数据库中的表现形式，将jammdb数据库移植到riscv裸机平台上，并实现设计的文件系统，良好的设计能减少由于数据库限制带来的性能损失。

**比较分析法**：通过提供常见的POSIX文件系统接口，将实现的文件系统与其它文件系统(FAT32)进行对比，分析DBFS与常见的文件系统实现性能差距与优势。

### 实验方案





## 研究计划及进度安排



## 创新点及预期研究成果



## 参考文献

```
@article{wright2007extending,
  title={Extending ACID semantics to the file system},
  author={Wright, Charles P and Spillane, Richard and Sivathanu, Gopalan and Zadok, Erez},
  journal={ACM Transactions on Storage (TOS)},
  volume={3},
  number={2},
  pages={4--es},
  year={2007},
  publisher={ACM New York, NY, USA}
}
```



```
@inproceedings{oh2022exf2fs,
  title={$\{$exF2FS$\}$: Transaction Support in $\{$Log-Structured$\}$ Filesystem},
  author={Oh, Joontaek and Ji, Sion and Kim, Yongjin and Won, Youjip},
  booktitle={20th USENIX Conference on File and Storage Technologies (FAST 22)},
  pages={345--362},
  year={2022}
}
```

```
@article{kalita2019durablefs,
  title={DurableFS: a file system for NVRAM},
  author={Kalita, Chandan and Barua, Gautam and Sehgal, Priya},
  journal={CSI Transactions on ICT},
  volume={7},
  number={4},
  pages={277--286},
  year={2019},
  publisher={Springer}
}
```